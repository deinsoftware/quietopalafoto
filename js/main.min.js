$(document).ready(function() { setTimeout(() => { loadTwitter(); loadFacebook(); loadRestrictions(); }, 3000); }); /*Twitter*/ var loadHeight = function () { }; var loadTwitter = function () { var difference = $("#twitter-widget-0").height() + ($('#maps').height() - $("#twitter-widget-0").height()) - 5; $('#tweets').height($('#maps').height()); $("#twitter-widget-0").css({ height: difference + 'px' }); }; /*Facebook*/ var fbURL = 'https://www.facebook.com/'; var fbPage = 'quietopalafoto'; var fbAPI = 'https://graph.facebook.com/' + 'v2.7/'; var fbToken = '&access_token=763465203723077|2a943f653712fcce25de89d9247e2654'; var loadFacebook = function() { var urlPage = fbURL + fbPage; $('[id^=fan]').attr("href", urlPage); var urlFan = fbPage + '/?fields=fan_count'; $.getJSON(fbAPI + urlFan + fbToken + '&callback=?', function(json) { if (json.fan_count) { $('#news span.badge').text(json.fan_count); } else { $('#fbk-fan').hide(); } }); var urlPost = fbPage + '/feed/?limit=12'; $.getJSON(fbAPI + urlPost + fbToken + '&callback=?', function(json) { var html = ''; $.each(json.data, function(i, fb) { html += '<div class="col-sm-6 col-md-4">'; html += '<div id="' + fb.id + '" class="well well-sm">'; /* attach will be here */ html += '</div>'; html += '</div>'; var urlDetail = fb.id + '/?fields=attachments,likes.summary(true),shares,comments.summary(true)'; $.getJSON(fbAPI + urlDetail + fbToken + '&callback=?', function(json) { var attach = ''; attach += '<a href="' + fbURL + fb.id + '">'; if (json.attachments.data[0].type === 'album') { attach += '<div class=image-full style="background-image: url(\'' + json.attachments.data[0].subattachments.data[0].media.image.src + '\');">'; } else { attach += '<div class=image-full style="background-image: url(\'' + json.attachments.data[0].media.image.src + '\');">'; } attach += '</div>'; attach += '<div class=item-content>'; attach += '<div class=item-text>'; attach += ' ' + (fb.message ? fb.message : json.attachments.data[0].title ? json.attachments.data[0].title.cleanSource() : '') + ''; attach += '</div>'; attach += '</div>'; attach += '</div></a>'; $(attach).appendTo('#' + fb.id); }); if ((i + 1) % 2 === 0) { html += '<div class="clearfix visible-sm-block"></div>'; } if ((i + 1) % 3 === 0) { html += '<div class="clearfix visible-md-block visible-lg-block"></div>'; } }); $(html).appendTo('#feed'); }); }; String.prototype.cleanSource = function () { var titleValue = this; var jsonFilter = [ " - El Colombiano.com", " • ENTER.CO", "-H13 Noticias", " - La FM", " | Minuto30.com", " - NeoTeo", "[Noticias]", " - Teleantioquia", " - Telemedellín", " - tuexperto.com", "Reportaje:", "VIDEO:", "Vídeo. ", " |" ]; $.each(jsonFilter, function(i, filter) { titleValue = titleValue.replace(filter, ''); }); return titleValue; }; /*jslint browser:true */ var _gaq=_gaq||[]; _gaq.push(['_setAccount','UA-1931813-9']); _gaq.push(['_setDomainName','.quietopalafoto.com']); _gaq.push(['_trackPageview']); (function(){ var ga=document.createElement('script'); ga.type='text/javascript'; ga.async=true; ga.src=('https:'===document.location.protocol?'https://ssl':'http://www')+'.google-analytics.com/ga.js'; var s=document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga,s); })(); { "pyp": { "schedule": [ { "date": { "start": "2019-02-04T00:00:00.000Z" }, "level": 1, "type": { "vehicle": { "day": { "mo": [ 8, 9, 0, 1 ], "tu": [ 2, 3, 4, 5 ], "we": [ 6, 7, 8, 9 ], "th": [ 0, 1, 2, 3 ], "fr": [ 4, 5, 6, 7 ] }, "class": { "truck": { "apply": true }, "car": { "apply": true }, "cab": { "model": { "2019": [ { "start": "0600", "end": "2000" } ] }, "date": { "2019-02-14": 0, "2019-02-28": 0, "2019-03-15": 0, "2019-03-29": 0, "2019-04-08": 0, "2019-04-22": 0, "2019-05-07": 0, "2019-05-21": 0, "2019-06-05": 0, "2019-06-19": 0, "2019-07-04": 0, "2019-07-18": 0, "2019-02-08": 1, "2019-02-22": 1, "2019-03-04": 1, "2019-03-18": 1, "2019-04-02": 1, "2019-04-16": 1, "2019-04-30": 1, "2019-05-15": 1, "2019-05-29": 1, "2019-06-13": 1, "2019-06-27": 1, "2019-07-12": 1, "2019-07-26": 1, "2019-02-01": 2, "2019-02-11": 2, "2019-02-25": 2, "2019-03-12": 2, "2019-03-26": 2, "2019-04-10": 2, "2019-04-24": 2, "2019-05-16": 2, "2019-05-30": 2, "2019-06-14": 2, "2019-06-28": 2, "2019-07-08": 2, "2019-07-22": 2, "2019-02-05": 3, "2019-02-19": 3, "2019-03-06": 3, "2019-03-20": 3, "2019-04-04": 3, "2019-05-02": 3, "2019-05-17": 3, "2019-05-31": 3, "2019-06-10": 3, "2019-07-09": 3, "2019-07-23": 3, "2019-02-06": 4, "2019-02-20": 4, "2019-03-07": 4, "2019-03-21": 4, "2019-04-05": 4, "2019-05-03": 4, "2019-05-13": 4, "2019-05-27": 4, "2019-06-11": 4, "2019-06-25": 4, "2019-07-10": 4, "2019-07-24": 4, "2019-02-07": 5, "2019-02-21": 5, "2019-03-08": 5, "2019-03-22": 5, "2019-04-01": 5, "2019-04-15": 5, "2019-04-29": 5, "2019-05-14": 5, "2019-05-28": 5, "2019-06-12": 5, "2019-06-26": 5, "2019-07-11": 5, "2019-07-25": 5, "2019-02-15": 6, "2019-03-01": 6, "2019-03-11": 6, "2019-04-09": 6, "2019-04-23": 6, "2019-05-08": 6, "2019-05-22": 6, "2019-06-06": 6, "2019-06-20": 6, "2019-07-05": 6, "2019-07-19": 6, "2019-02-04": 7, "2019-02-18": 7, "2019-03-05": 7, "2019-03-19": 7, "2019-04-03": 7, "2019-04-17": 7, "2019-05-09": 7, "2019-05-23": 7, "2019-06-07": 7, "2019-06-21": 7, "2019-07-15": 7, "2019-07-29": 7, "2019-02-12": 8, "2019-02-26": 8, "2019-03-13": 8, "2019-03-27": 8, "2019-04-11": 8, "2019-04-25": 8, "2019-05-10": 8, "2019-05-24": 8, "2019-06-17": 8, "2019-07-02": 8, "2019-07-16": 8, "2019-07-30": 8, "2019-02-13": 9, "2019-02-27": 9, "2019-03-14": 9, "2019-03-28": 9, "2019-04-12": 9, "2019-04-26": 9, "2019-05-06": 9, "2019-05-20": 9, "2019-06-04": 9, "2019-06-18": 9, "2019-07-03": 9, "2019-07-17": 9, "2019-07-31": 9 }, "apply": true } }, "order": "last" }, "bike": { "day": { "mo": [ 4, 5 ], "tu": [ 6, 7 ], "we": [ 8, 9 ], "th": [ 0, 1 ], "fr": [ 2, 3 ] }, "class": { "4T": { "apply": false }, "2T": { "apply": true } }, "order": "first" }, "model": { "2019": [ { "start": "0700", "end": "0830" }, { "start": "1730", "end": "1900" } ] } } }, { "date": { "alert": "2019-02-04T00:00:00.000Z", "start": "2019-02-18T00:00:00.000Z", "end": "2019-03-30T00:00:00.000Z" }, "level": 2, "type": { "vehicle": { "day": { "mo": [ 6, 7, 8, 9, 0, 1 ], "tu": [ 0, 1, 2, 3, 4, 5 ], "we": [ 4, 5, 6, 7, 8, 9 ], "th": [ 8, 9, 0, 1, 2, 3 ], "fr": [ 2, 3, 4, 5, 6, 7 ] }, "class": { "truck": { "model": { "2009": [ { "start": "0500", "end": "0830" }, { "start": "1630", "end": "2100" } ] }, "apply": true }, "car": { "apply": true } }, "order": "last" }, "bike": { "day": { "mo": [ 4, 5, 6, 7, 8, 9 ], "tu": [ 6, 7, 8, 9, 0, 1 ], "we": [ 8, 9, 0, 1, 2, 3 ], "th": [ 0, 1, 2, 3, 4, 5 ], "fr": [ 2, 3, 4, 5, 6, 7 ] }, "class": { "4T": { "apply": true }, "2T": { "apply": true } }, "order": "first" }, "model": { "1996": [ { "start": "0500", "end": "0830" }, { "start": "1630", "end": "2100" } ] }, "day": { "sa": { "even": ["2019-02-23", "2019-03-09", "2019-03-23"], "odd": ["2019-03-02", "2019-03-16", "2019-03-30"] } }, "date": { "2019-02-23": [ 0, 2, 4, 6, 8 ], "2019-03-02": [ 1, 3, 5, 7, 9 ], "2019-03-09": [ 0, 2, 4, 6, 8 ], "2019-03-16": [ 1, 3, 5, 7, 9 ], "2019-03-23": [ 0, 2, 4, 6, 8 ], "2019-03-30": [ 1, 3, 5, 7, 9 ] } } } ] } } function convertISOtoDate(value, format) { if (!value) { return ''; } var date = new Date(value); var result = ''; switch (format) { case 'short': result = date.getDate() + 1 + ' ' + getMonthName(date.getMonth(), shortMonthsName); break; case 'long': result = date.getDate() + 1 + ' ' + getMonthName(date.getMonth(), longMonthsName); break; default: result = date.toISOString().substr(0, 10); break; } return result; } var shortMonthsName = [ 'Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic', ]; var longMonthsName = [ 'Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre', ]; function getMonthName(month, nameList) { if (!month) { return ''; } return nameList[month]; } function convertISOtoYear(value) { if (!value) { return ''; } var date = new Date(value); return date.getFullYear(); } function convertMilitarToStandardTime(military) { if (!military) { return ''; } var hour = military.substring(2, 0); var mins = military.substring(2); return (hour > 12 ? hour - 12 : hour * 1) + ':' + mins; } function getMeridian(military) { if (!military) { return ''; } var hour = military.substring(2, 0); return hour < 12 ? 'AM' : 'PM'; } function getTimeRange(time) { if (!time) { return ''; } var range = convertMilitarToStandardTime(time.start) + '-' + convertMilitarToStandardTime(time.end) + ' ' + getMeridian(time.end); return range; } function getWeekDay(day) { var date = new Date(); var weekDay = new Date(date.setDate(date.getDate() - date.getDay() + day)); return weekDay; } var restrictions = {}; var filterData = function(data) { data = data.pyp.schedule; data = data.filter( (e) => (new Date(e.date.alert) < Date.now() || new Date(e.date.start) < Date.now()) && (!e.date.end || Date.now() < new Date(e.date.end)), ); return data; }; var currentData = function(data) { data.forEach((element) => { $.extend(true, restrictions, element); }); }; $.ajax({ url: '../data/restrictions.json', dataType: 'json', cache: false, success: function(data, status) { data = filterData(data); currentData(data); }, error: function(xhr, textStatus, err) { console.log( 'readyState: ' + xhr.readyState + '\n xhrStatus: ' + xhr.status, ); console.log('responseText: ' + xhr.responseText); }, }); var types = ['vehicle', 'bike']; var weekDays = ['mo', 'tu', 'we', 'th', 'fr']; function loadRestrictions() { if (restrictions && restrictions.level) { var level = ''; var hash = ''; switch (restrictions.level) { case 2: level = 'warning'; hash = '#AlertaNaranja'; break; case 3: level = 'danger'; hash = '#AlertaRoja'; break; default: level = 'info'; break; } if (restrictions.level > 1) { $('#level').removeClass('hidden-lg'); $('#level-number').text(restrictions.level); $('#restrictions') .removeClass('panel-info') .addClass('panel-' + level); $('#restrictions .alert-info') .removeClass('alert-info') .addClass('alert-' + level); $('#restrictions .text-info') .removeClass('text-info') .addClass('text-' + level); $('#restrictions-title strong').removeClass( 'hidden-xs hidden-sm hidden-md hidden-lg', ); $('#restrictions-title span').text(hash); var bike = []; restrictions.type.bike.class['2T'].apply && bike.push('2T'); restrictions.type.bike.class['4T'].apply && bike.push('4T'); $('#bike-title span').text(bike.join('/')); types.map((type) => weekDays.map((day) => weekRestriction(type, day))); var start = convertISOtoDate(restrictions.date.start, 'long'); var end = convertISOtoDate(restrictions.date.end, 'long'); $('#schedule-models strong span') .eq(0) .text('Desde ' + start); $('#schedule-models strong span') .eq(1) .text(end && ' a ' + end); var day = restrictions.type.day; if (day.sa) { $('#weekend').removeClass('hidden-xs hidden-sm hidden-md hidden-lg'); var even = day.sa.even.map((date) => convertISOtoDate(date, 'short')); $('#all-sa-even').text(even.join(', ')); var odd = day.sa.odd.map((date) => convertISOtoDate(date, 'short')); $('#all-sa-odd').text(odd.join(', ')); } } $('#schedule-models').removeClass( 'hidden-xs hidden-sm hidden-md hidden-lg', ); var models = restrictions.type.model; for (var key in models) { if (models.hasOwnProperty(key)) { var morning = models[key][0]; var night = models[key][1]; var range = ''; range += getTimeRange(morning); range += ' | '; range += getTimeRange(night); if ((key | 0) === convertISOtoYear(Date.now())) { $('#schedule').text(range); } else { var html = ''; html += '<div>'; html += $('<span>', { class: 'visible-xs' }) .text(' ' + key + ': ' + range) .prop('outerHTML'); html += $('<span>', { class: 'hidden-xs' }) .text('Modelos ' + key + ' o inferiores ' + range) .prop('outerHTML'); html += '</span></span></div>'; $('#schedule-models > div').append(html); } } } var abbr = $('<abbr>', { title: 'Modelos igual o inferiores' }) .text('≥') .prop('outerHTML'); $('#schedule-models > div span:first-child').prepend(abbr); } } function weekRestriction(type, day) { var numbers = restrictions.type[type].day[day]; $('#' + type + '-' + day).text(numbers.join('-')); } /*jQuery to collapse the navbar on scroll*/ $(window).scroll(function() { if ($(".navbar").offset().top > 50) { $(".navbar-fixed-top").addClass("top-nav-collapse"); } else { $(".navbar-fixed-top").removeClass("top-nav-collapse"); } }); /*jQuery for page scrolling feature - requires jQuery Easing plugin*/ $(function() { $('a.page-scroll').bind('click', function(event) { var $anchor = $(this); $('html, body').stop().animate({ scrollTop: $($anchor.attr('href')).offset().top }, 1500, 'easeInOutExpo'); event.preventDefault(); }); }); if (self === top) { var antiClickjack = document.getElementById("antiClickjack"); antiClickjack.parentNode.removeChild(antiClickjack); } else { top.location = self.location; } if (window.matchMedia('(display-mode: standalone)').matches) { $('a').not('page-scroll').on('click', function () { $(this).attr("target", "_blank"); }); }</abbr>